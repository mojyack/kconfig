set arch amd64
include frag/general

# arch
include frag/arch/x86/amd64
CONFIG_CPU_SUP_INTEL=y
CONFIG_MSKYLAKE=y
CONFIG_NR_CPUS=8
CONFIG_X86_MCE_INTEL=y

# boot
CONFIG_CMDLINE_BOOL=y
CONFIG_CMDLINE="root=PARTUUID=50ad3cac-2647-4945-b5a1-46ae4a3bb357 rw loglevel=3 mitigations=off fsck.mode=skip"

include frag/arch/x86/efi
CONFIG_EFI_STUB=y

# thermal
CONFIG_INTEL_POWERCLAMP=m
CONFIG_X86_PKG_TEMP_THERMAL=m
CONFIG_INTEL_PCH_THERMAL=m
CONFIG_INTEL_TCC_COOLING=m

# hwmon
CONFIG_SENSORS_CORETEMP=m

# perf
CONFIG_PERF_EVENTS_INTEL_UNCORE=m
CONFIG_PERF_EVENTS_INTEL_RAPL=m
CONFIG_PERF_EVENTS_INTEL_CSTATE=m

# acpi
include frag/drivers/acpi
CONFIG_ACPI_AC=m
CONFIG_ACPI_BATTERY=m
CONFIG_ACPI_PROCESSOR_AGGREGATOR=m
CONFIG_INTEL_IDLE=y

include frag/fs/nfs
include frag/extra/zram
include frag/extra/gentoo

### drivers ###
# pci
include frag/drivers/pci

# mfd
CONFIG_MFD_INTEL_LPSS_PCI=m
CONFIG_MFD_SYSCON=y

# i2c
CONFIG_I2C_DESIGNWARE_CORE=m
CONFIG_I2C_I801=m
CONFIG_I2C_DESIGNWARE_PLATFORM=m

# input
CONFIG_HID_MULTITOUCH=m
CONFIG_KEYBOARD_ATKBD=m
CONFIG_INPUT_UINPUT=m
CONFIG_I2C_HID=m
CONFIG_I2C_HID_ACPI=m

# pinctrl
CONFIG_PINCTRL=y
CONFIG_PINCTRL_CANNONLAKE=m

# mei
CONFIG_INTEL_MEI=m
CONFIG_INTEL_MEI_ME=m
CONFIG_INTEL_MEI_HDCP=m
CONFIG_INTEL_MEI_PXP=m

# block
include frag/extra/sata-rootfs

# ethernet
CONFIG_ETHERNET=y
CONFIG_NET_VENDOR_INTEL=y
CONFIG_E1000E=m
CONFIG_E1000E_HWTS=n

# wifi
CONFIG_WLAN=y
CONFIG_WLAN_VENDOR_INTEL=y
CONFIG_IWLWIFI=m
CONFIG_IWLMVM=m

# bluetooth
include frag/net/wireless
include frag/net/bluetooth/usb
CONFIG_BT_HCIBTUSB_BCM=y
CONFIG_BT_HCIBTUSB_RTL=y

# modem
CONFIG_USB_NET_DRIVERS=m
CONFIG_USB_USBNET=m
CONFIG_USB_NET_CDC_MBIM=m

# gpio
include frag/drivers/gpio

# gpu
include frag/drivers/drm/i915
CONFIG_DRM_I915=y
CONFIG_EXTRA_FIRMWARE="i915/kbl_dmc_ver1_04.bin"
CONFIG_EXTRA_FIRMWARE_DIR="/lib/firmware"

# sound
include frag/drivers/sound/hda
CONFIG_SND_HDA_CODEC_REALTEK=m
CONFIG_SND_HDA_CODEC_HDMI=m

CONFIG_SND_SOC=y
CONFIG_SND_SOC_SOF_TOPLEVEL=y
CONFIG_SND_SOC_SOF_PCI=m
CONFIG_SND_SOC_SOF_INTEL_TOPLEVEL=y
CONFIG_SND_SOC_SOF_CANNONLAKE=m
CONFIG_SND_SOC_SOF_HDA_LINK=y
CONFIG_SND_SOC_SOF_HDA_AUDIO_CODEC=y

include frag/drivers/sound/usb

# usb
CONFIG_USB_XHCI_HCD=m
CONFIG_TYPEC=m
CONFIG_TYPEC_UCSI=m
CONFIG_UCSI_ACPI=m
CONFIG_TYPEC_DP_ALTMODE=m
CONFIG_USB_ROLE_SWITCH=m
CONFIG_USB_SERIAL=m
CONFIG_USB_SERIAL_CH341=m

# mmc
CONFIG_MMC=m
CONFIG_MMC_BLOCK=m
CONFIG_MMC_SDHCI=m
CONFIG_MMC_SDHCI_PCI=m

# rtc
include frag/drivers/rtc
CONFIG_RTC_DRV_CMOS=m

# dma
CONFIG_DMADEVICES=y
CONFIG_INTEL_IDMA64=m

# platform
CONFIG_FUJITSU_LAPTOP=m
CONFIG_INTEL_WMI_THUNDERBOLT=m

# powercap
CONFIG_POWERCAP=y
CONFIG_INTEL_RAPL=m

CONFIG_TUN=m
