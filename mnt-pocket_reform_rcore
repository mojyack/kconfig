set arch arm64
include frag/general

# arch
include frag/arch/arm64/general
include frag/arch/arm64/feats/armv8-1
include frag/arch/arm64/feats/armv8-2
include frag/arch/arm64/erratum/cortex-a55
include frag/arch/arm64/erratum/cortex-a76
CONFIG_ROCKCHIP_ERRATUM_3588001=y

erase CONFIG_ARM64_ERRATUM_1418040 # !COMPAT

CONFIG_ARCH_ROCKCHIP=y
CONFIG_NR_CPUS=8

CONFIG_ARM64_4K_PAGES=y
CONFIG_PAGE_BLOCK_ORDER=10 # "11" if 16K, "13" if 64K
CONFIG_ARM64_VA_BITS_52=y
CONFIG_ARM64_PA_BITS_52=y
CONFIG_CMA=y

CONFIG_CPUFREQ_DT=m

include frag/fs/nfs
include frag/extra/zram

### drivers ###
# pci
include frag/drivers/pci
CONFIG_PCIE_ROCKCHIP_DW_HOST=y

# firmware
CONFIG_ARM_SCMI_PROTOCOL=y
CONFIG_ARM_SCMI_TRANSPORT_SMC=y
CONFIG_ARM_SMCCC_SOC_ID=y

# block
CONFIG_BLK_DEV_NBD=m
include frag/drivers/nvme
CONFIG_BLK_DEV_NVME=y  # root device

# misc
CONFIG_SRAM=y

# sata
CONFIG_AHCI_DWC=n  # no sata port

# net
CONFIG_TUN=m
CONFIG_ETHERNET=y
CONFIG_ETHTOOL_NETLINK=y
CONFIG_NET_VENDOR_STMICRO=y
CONFIG_STMMAC_ETH=m
CONFIG_STMMAC_PLATFORM=m
CONFIG_DWMAC_ROCKCHIP=m
CONFIG_ROCKCHIP_PHY=m

# usb net
CONFIG_USB_NET_DRIVERS=m
CONFIG_USB_USBNET=m
CONFIG_USB_NET_AX88179_178A=m

# wifi
include frag/net/wireless
CONFIG_WLAN=y
CONFIG_WLAN_VENDOR_MEDIATEK=y
CONFIG_MT76x2U=m

# input
CONFIG_INPUT_RK805_PWRKEY=m

# char
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y  # CONFIG_SERIAL_8250 == y
CONFIG_SERIAL_8250_DMA=y
CONFIG_SERIAL_8250_EXTENDED=y
CONFIG_SERIAL_8250_SHARE_IRQ=y
CONFIG_SERIAL_8250_DW=y  # early serial console
CONFIG_HW_RANDOM=m
CONFIG_HW_RANDOM_ROCKCHIP=m

# i2c
CONFIG_I2C_RK3X=m

# spi
CONFIG_SPI=y
CONFIG_SPI_ROCKCHIP=m
CONFIG_SPI_SPIDEV=m
CONFIG_SPI_ROCKCHIP_SFC=n  # no spi flash

# ptp
CONFIG_PTP_1588_CLOCK=m

# pinctrl
CONFIG_PINCTRL_ROCKCHIP=y

# gpio
CONFIG_GPIO_ROCKCHIP=y

# thermal
CONFIG_ROCKCHIP_THERMAL=y

# wdt
include frag/drivers/watchdog
CONFIG_DW_WATCHDOG=m

# mfd
CONFIG_MFD_RK8XX_I2C=y
CONFIG_MFD_RK8XX_SPI=y

# regulator
CONFIG_REGULATOR=y
CONFIG_REGULATOR_FIXED_VOLTAGE=y
CONFIG_REGULATOR_FAN53555=m
CONFIG_REGULATOR_RK808=m

# media
CONFIG_MEDIA_PLATFORM_DRIVERS=y
CONFIG_V4L_PLATFORM_DRIVERS=y
CONFIG_V4L_MEM2MEM_DRIVERS=y
CONFIG_VIDEO_ROCKCHIP_RGA=m
CONFIG_VIDEO_ROCKCHIP_VDEC2=m
CONFIG_VIDEO_SYNOPSYS_HDMIRX=n  # no hdmi rx
CONFIG_VIDEO_HANTRO=m
CONFIG_VIDEO_HANTRO_ROCKCHIP=y

# drm
CONFIG_DRM_ROCKCHIP=y
CONFIG_ROCKCHIP_VOP2=y
CONFIG_ROCKCHIP_DW_DP=y
CONFIG_ROCKCHIP_DW_HDMI=y
CONFIG_ROCKCHIP_DW_HDMI_QP=y
CONFIG_ROCKCHIP_DW_MIPI_DSI=y
CONFIG_ROCKCHIP_DW_MIPI_DSI2=y
CONFIG_ROCKCHIP_LVDS=y
CONFIG_DRM_PANEL_MNT_POCKET_REFORM=y
CONFIG_DRM_PANTHOR=m
CONFIG_BACKLIGHT_CLASS_DEVICE=m

# rocket
CONFIG_DRM_ACCEL_ROCKET=m

# sound
CONFIG_SND_SOC=m
CONFIG_SND_SOC_ROCKCHIP=m
CONFIG_SND_SOC_ROCKCHIP_I2S_TDM=m
CONFIG_SND_SOC_ROCKCHIP_SPDIF=n  # no spdif
CONFIG_SND_SOC_TLV320AIC31XX=m
CONFIG_SND_SIMPLE_CARD=m
CONFIG_SND_AUDIO_GRAPH_CARD=m

include frag/drivers/sound/usb

# usb
CONFIG_USB_ULPI_BUS=m
CONFIG_USB_XHCI_HCD=m
CONFIG_USB_EHCI_HCD=m
CONFIG_USB_EHCI_TT_NEWSCHED=y
CONFIG_USB_EHCI_HCD_PLATFORM=m
CONFIG_USB_OHCI_HCD=m
CONFIG_USB_OHCI_HCD_PLATFORM=m
CONFIG_USB_DWC3=m
CONFIG_USB_DWC3_ULPI=y
CONFIG_USB_ONBOARD_DEV=m
CONFIG_TYPEC=m

# mmc
CONFIG_MMC=m
CONFIG_MMC_BLOCK=m
CONFIG_MMC_SDHCI=m
CONFIG_MMC_SDHCI_PLTFM=m
CONFIG_MMC_SDHCI_OF_DWCMSHC=m
CONFIG_MMC_DW=m
CONFIG_MMC_DW_ROCKCHIP=m

# led
CONFIG_NEW_LEDS=y
CONFIG_LEDS_CLASS=m

# rtc
include frag/drivers/rtc
CONFIG_RTC_DRV_PCF8523=m

# dma
CONFIG_DMADEVICES=y
CONFIG_PL330_DMA=m

# staging
CONFIG_STAGING=y
CONFIG_STAGING_MEDIA=y
CONFIG_VIDEO_ROCKCHIP_VDEC=m

# common-clock
CONFIG_COMMON_CLK_SCMI=y
CONFIG_COMMON_CLK_ROCKCHIP=y
CONFIG_CLK_RK3588=y

# timer
CONFIG_ARM_ARCH_TIMER_EVTSTREAM=y

# iommu
CONFIG_IOMMU_DEFAULT_PASSTHROUGH=y
#CONFIG_ARM_SMMU_V3=m  # causes pci failure
CONFIG_ROCKCHIP_IOMMU=y

# pm domain
CONFIG_ROCKCHIP_PM_DOMAINS=y

# dvfs
CONFIG_PM_DEVFREQ_EVENT=y
CONFIG_DEVFREQ_EVENT_ROCKCHIP_DFI=m

# extcon
CONFIG_EXTCON=y  # required!

# iio
CONFIG_IIO=m
CONFIG_ROCKCHIP_SARADC=m

# pwm
CONFIG_PWM=y
CONFIG_PWM_ROCKCHIP=m

# reset controller
CONFIG_RESET_SIMPLE=y

# phy
CONFIG_PHY_ROCKCHIP_INNO_USB2=m
CONFIG_PHY_ROCKCHIP_NANENG_COMBO_PHY=y
CONFIG_PHY_ROCKCHIP_SAMSUNG_DCPHY=m
CONFIG_PHY_ROCKCHIP_SAMSUNG_HDPTX=m
CONFIG_PHY_ROCKCHIP_SNPS_PCIE3=y
CONFIG_PHY_ROCKCHIP_USB=m
CONFIG_PHY_ROCKCHIP_USBDP=m

# pmu
CONFIG_ARM_PMU=y

# nvmem
CONFIG_NVMEM=y
CONFIG_NVMEM_SYSFS=y
CONFIG_NVMEM_ROCKCHIP_OTP=m

# tee
CONFIG_TEE=m
CONFIG_OPTEE=m
